"use strict";(self.webpackChunkblogproject=self.webpackChunkblogproject||[]).push([[472],{5472:function(e,t,n){n.r(t);var s,r=n(4165),a=n(1413),c=n(5861),i=n(9439),l=n(168),u=n(2791),o=n(6444),d=n(385),h=n(3330),p=n(3117),g=n(6848),f=n(1134),x=n(5456),m=n(9501),j=n(333),v=n.n(j),Z=n(3585),b=n(2441),E=n(1776),k=n(4961),w=n(9062),y=n(1199),N=n(9808),I=n(9085),P=n(8322),C=n(184),S=o.ZP.div(s||(s=(0,l.Z)([""])));t.default=function(){var e=(0,N.a)().userInfo,t=(0,f.cI)({mode:"onChange",defaultValues:{title:"",slug:"",status:2,author:"",hot:!1,image:"",category:{},user:{}}}),n=t.control,s=t.watch,l=t.setValue,o=t.handleSubmit,j=t.getValues,A=t.reset,D=(0,u.useState)([]),L=(0,i.Z)(D,2),J=L[0],R=L[1],_=(0,u.useState)(""),O=(0,i.Z)(_,2),T=O[0],V=O[1],Y=(0,E.Z)(l,j),B=Y.image,G=Y.handleResetUpload,U=Y.progress,q=Y.handleSelectImage,z=Y.handleDeleteImage,F=s("status"),M=s("hot"),Q=(0,u.useState)(!1),H=(0,i.Z)(Q,2),K=H[0],W=H[1],X=function(){var e=(0,c.Z)((0,r.Z)().mark((function e(t){var n,s;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return W(!0),e.prev=1,(n=(0,a.Z)({},t)).slug=v()(t.slug||t.title,{lower:!0}),n.status=Number(t.status),s=(0,w.hJ)(y.db,"posts"),e.next=8,(0,w.ET)(s,(0,a.Z)((0,a.Z)({},n),{},{image:B,createAt:(0,w.Bt)()}));case 8:I.Am.success("Create new post successfully!"),A({title:"",slug:"",status:2,hot:!1,image:"",category:{},user:{}}),G(),V({}),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(1),W(!1);case 17:return e.prev=17,W(!1),e.finish(17);case 20:case"end":return e.stop()}}),e,null,[[1,14,17,20]])})));return function(t){return e.apply(this,arguments)}}();(0,u.useEffect)((function(){function t(){return(t=(0,c.Z)((0,r.Z)().mark((function t(){var n;return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.email){t.next=2;break}return t.abrupt("return");case 2:return n=(0,w.IO)((0,w.hJ)(y.db,"users"),(0,w.ar)("email","==",e.email)),t.next=5,(0,w.PL)(n);case 5:t.sent.forEach((function(e){l("user",(0,a.Z)({id:e.id},e.data()))}));case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[e.email]),(0,u.useEffect)((function(){function e(){return(e=(0,c.Z)((0,r.Z)().mark((function e(){var t,n,s,c;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,w.hJ)(y.db,"categories"),n=(0,w.IO)(t,(0,w.ar)("status","==",1)),e.next=4,(0,w.PL)(n);case 4:s=e.sent,c=[],s.forEach((function(e){c.push((0,a.Z)({id:e.id},e.data()))})),console.log("getData ~ result",c),R(c);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),(0,u.useEffect)((function(){document.title="Monkey Blogging - Add new post"}),[]);var $=function(){var e=(0,c.Z)((0,r.Z)().mark((function e(t){var n,s;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,w.JU)(y.db,"categories",t.id),e.next=3,(0,w.QT)(n);case 3:s=e.sent,l("category",(0,a.Z)({id:s.id},s.data())),V(t);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,C.jsxs)(S,{children:[(0,C.jsx)(P.Z,{title:"Add post",desc:"Add new post"}),(0,C.jsxs)("form",{onSubmit:o(X),children:[(0,C.jsxs)("div",{className:"grid grid-cols-2 gap-x-10 mb-10",children:[(0,C.jsxs)(h.g,{children:[(0,C.jsx)(g._,{children:"Title"}),(0,C.jsx)(p.I,{control:n,placeholder:"Enter your title",name:"title",required:!0})]}),(0,C.jsxs)(h.g,{children:[(0,C.jsx)(g._,{children:"Slug"}),(0,C.jsx)(p.I,{control:n,placeholder:"Enter your slug",name:"slug"})]})]}),(0,C.jsxs)("div",{className:"grid grid-cols-2 gap-x-10 mb-10",children:[(0,C.jsxs)(h.g,{children:[(0,C.jsx)(g._,{children:"Image"}),(0,C.jsx)(b.Z,{onChange:q,className:"h-[250px]",progress:U,image:B,handleDeleteImage:z})]}),(0,C.jsxs)(h.g,{children:[(0,C.jsx)(g._,{children:"Category"}),(0,C.jsxs)(m.L,{children:[(0,C.jsx)(m.L.Select,{placeholder:"Select the category"}),(0,C.jsx)(m.L.List,{children:J.length>0&&J.map((function(e){return(0,C.jsxs)(m.L.Option,{onClick:function(){return $(e)},children:[e.name," "]},e.id)}))})]}),(null===T||void 0===T?void 0:T.name)&&(0,C.jsx)("span",{className:"inline-block p-3 rounded-lg bg-green-50 text-green-700  text-sm font-bold",children:null===T||void 0===T?void 0:T.name})]})]}),(0,C.jsxs)("div",{className:"grid grid-cols-2 gap-x-10 mb-10",children:[(0,C.jsxs)(h.g,{children:[(0,C.jsx)(g._,{children:"Feature Post"}),(0,C.jsx)(k.Z,{on:!0===M,onClick:function(){return l("hot",!M)}})]}),(0,C.jsxs)(h.g,{children:[(0,C.jsx)(g._,{children:"Status"}),(0,C.jsxs)(h.Y,{children:[(0,C.jsx)(x.Y,{name:"status",control:n,checked:Number(F)===Z.cf.APPROVED,value:Z.cf.APPROVED,children:"Approved"}),(0,C.jsx)(x.Y,{name:"status",control:n,checked:Number(F)===Z.cf.PENDING,value:Z.cf.PENDING,children:"Pending"}),(0,C.jsx)(x.Y,{name:"status",control:n,checked:Number(F)===Z.cf.REJECTED,value:Z.cf.REJECTED,children:"Reject"})]})]})]}),(0,C.jsx)(d.z,{type:"submit",className:"mx-auto w-[250px]",isLoading:K,disabled:K,children:"Add new post"})]})]})}}}]);
//# sourceMappingURL=472.0a11f4f2.chunk.js.map