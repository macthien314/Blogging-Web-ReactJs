"use strict";(self.webpackChunkblogproject=self.webpackChunkblogproject||[]).push([[297],{297:function(e,t,n){n.r(t);var r=n(1413),a=n(9439),s=n(4165),c=n(5861),i=n(9062),u=n(2791),o=n(1134),l=n(3504),d=n(6871),p=n(385),h=n(5456),f=n(9501),m=n(3330),g=n(2441),x=n(3117),j=n(6848),b=n(4961),v=n(1199),Z=n(1776),k=n(3585),y=n(8322),w=n(4569),E=n.n(w),N=n(6770),C=n.n(N),S=(n(6009),n(9085)),I=n(8113),U=n(333),D=n.n(U),P=n(184);N.Quill.register("modules/imageUploader",I.Z);t.default=function(){var e=(0,o.cI)({mode:"onChange",defaultValues:{title:"",slug:"",status:2,author:"",hot:!1,image:"",category:{},user:{}}}),t=e.control,n=e.handleSubmit,w=e.watch,N=e.setValue,I=e.getValues,U=e.reset,_=e.formState,J=_.isValid,L=_.isSubmitting,R=(0,u.useMemo)((function(){return{toolbar:[["bold","italic","underline","strike"],["blockquote"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{header:[1,2,3,4,5,6,!1]}],["link","image"]],imageUploader:{upload:function(){var e=(0,c.Z)((0,s.Z)().mark((function e(t){var n,r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=new FormData).append("image",t),e.next=4,E()({method:"post",url:"https://api.imgbb.com/1/upload?key=f7e3acfa6df95fd2479bacf8fcc90818",data:n,headers:{"Content-Type":"multipart/form-data"}});case 4:return r=e.sent,e.abrupt("return",r.data.data.url);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}}}),[]),T=(0,l.lr)(),V=(0,a.Z)(T,1)[0].get("id"),A=((0,d.s0)(),(0,u.useState)("")),O=(0,a.Z)(A,2),Y=O[0],F=O[1],Q=I("image"),q=I("image_name"),G=(0,Z.Z)(N,I,q,(function(){return $.apply(this,arguments)})),z=G.setImage,M=G.image,B=(G.handleResetUpload,G.progress),H=G.handleSelectImage,K=G.handleDeleteImage,W=w("status"),X=w("hot");function $(){return($=(0,c.Z)((0,s.Z)().mark((function e(){var t;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,i.JU)(v.db,"posts",V),e.next=3,(0,i.r7)(t,{image:""});case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}(0,u.useEffect)((function(){z(Q)}),[Q,z]);var ee=function(){var e=(0,c.Z)((0,s.Z)().mark((function e(t){var n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(J){e.next=2;break}return e.abrupt("return");case 2:return n=(0,i.JU)(v.db,"posts",V),t.status=Number(t.status),t.slug=D()(t.slug||t.title,{lower:!0}),e.next=7,(0,i.r7)(n,(0,r.Z)((0,r.Z)({},t),{},{image:M,content:Y}));case 7:S.Am.success("Update post successfully!");case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),te=(0,u.useState)([]),ne=(0,a.Z)(te,2),re=ne[0],ae=ne[1],se=(0,u.useState)(""),ce=(0,a.Z)(se,2),ie=ce[0],ue=ce[1];(0,u.useEffect)((function(){function e(){return(e=(0,c.Z)((0,s.Z)().mark((function e(){var t,n,a,c;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,i.hJ)(v.db,"categories"),n=(0,i.IO)(t,(0,i.ar)("status","==",1)),e.next=4,(0,i.PL)(n);case 4:a=e.sent,c=[],a.forEach((function(e){c.push((0,r.Z)({id:e.id},e.data()))})),console.log("getData ~ result",c),ae(c);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]);var oe=function(){var e=(0,c.Z)((0,s.Z)().mark((function e(t){var n,a;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,i.JU)(v.db,"categories",t.id),e.next=3,(0,i.QT)(n);case 3:a=e.sent,N("category",(0,r.Z)({id:a.id},a.data())),ue(t);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,u.useEffect)((function(){function e(){return(e=(0,c.Z)((0,s.Z)().mark((function e(){var t,n,r,a;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(V){e.next=2;break}return e.abrupt("return");case 2:return t=(0,i.JU)(v.db,"posts",V),e.next=5,(0,i.QT)(t);case 5:(n=e.sent).data()&&(U(n.data()),ue((null===(r=n.data())||void 0===r?void 0:r.category)||""),F((null===(a=n.data())||void 0===a?void 0:a.content)||""));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[V,U]),V?(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(y.Z,{title:"Update post",desc:"Update your post ".concat(V)}),(0,P.jsxs)("form",{onSubmit:n(ee),children:[(0,P.jsxs)("div",{className:"grid grid-cols-2 gap-x-10 mb-10",children:[(0,P.jsxs)(m.g,{children:[(0,P.jsx)(j._,{children:"Title"}),(0,P.jsx)(x.I,{control:t,placeholder:"Enter your title",name:"title",required:!0})]}),(0,P.jsxs)(m.g,{children:[(0,P.jsx)(j._,{children:"Slug"}),(0,P.jsx)(x.I,{control:t,placeholder:"Enter your slug",name:"slug"})]})]}),(0,P.jsxs)("div",{className:"grid grid-cols-2 gap-x-10 mb-10",children:[(0,P.jsxs)(m.g,{children:[(0,P.jsx)(j._,{children:"Image"}),(0,P.jsx)(g.Z,{onChange:H,className:"h-[250px]",progress:B,image:M,handleDeleteImage:K})]}),(0,P.jsxs)(m.g,{children:[(0,P.jsx)(j._,{children:"Category"}),(0,P.jsxs)(f.L,{children:[(0,P.jsx)(f.L.Select,{placeholder:"Select the category"}),(0,P.jsx)(f.L.List,{children:re.length>0&&re.map((function(e){return(0,P.jsxs)(f.L.Option,{onClick:function(){return oe(e)},children:[e.name," "]},e.id)}))})]}),(null===ie||void 0===ie?void 0:ie.name)&&(0,P.jsx)("span",{className:"inline-block p-3 rounded-lg bg-green-50 text-green-700  text-sm font-bold",children:null===ie||void 0===ie?void 0:ie.name})]})]}),(0,P.jsx)("div",{className:"mb-10 entry-content",children:(0,P.jsxs)(m.g,{children:[(0,P.jsx)(j._,{children:"Content"}),(0,P.jsx)("div",{className:"w-full",children:(0,P.jsx)(C(),{modules:R,theme:"snow",value:Y,onChange:F})})]})}),(0,P.jsxs)("div",{className:"grid grid-cols-2 gap-x-10 mb-10",children:[(0,P.jsxs)(m.g,{children:[(0,P.jsx)(j._,{children:"Feature Post"}),(0,P.jsx)(b.Z,{on:!0===X,onClick:function(){return N("hot",!X)}})]}),(0,P.jsxs)(m.g,{children:[(0,P.jsx)(j._,{children:"Status"}),(0,P.jsxs)(m.Y,{children:[(0,P.jsx)(h.Y,{name:"status",control:t,checked:Number(W)===k.cf.APPROVED,value:k.cf.APPROVED,children:"Approved"}),(0,P.jsx)(h.Y,{name:"status",control:t,checked:Number(W)===k.cf.PENDING,value:k.cf.PENDING,children:"Pending"}),(0,P.jsx)(h.Y,{name:"status",control:t,checked:Number(W)===k.cf.REJECTED,value:k.cf.REJECTED,children:"Reject"})]})]})]}),(0,P.jsx)(p.z,{type:"submit",className:"mx-auto w-[250px]",isLoading:L,disabled:L,children:"Update post"})]})]}):null}}}]);
//# sourceMappingURL=297.47a76d5f.chunk.js.map